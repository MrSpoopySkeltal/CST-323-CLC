<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org" xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GameHub • Browse Games</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" th:href="@{/css/products.css}"> <!-- COvermyer: MOVED CSS TO EXTERNAL FILE FOR CONVENIENCE -->
</head>
<body>
  <header class="nav">
    <div class="nav-inner">
      <a class="brand" href="/">GameHub</a>
      <nav class="nav-links">
        <a href="/">Home</a>
        <a href="/products">Games</a>
        <a href="/">About</a>
        <a href="/cart">Cart <span id="cartCount">0</span></a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <h1 class="title">Browse Games</h1>
    <p class="sub">Discover your next favorite game from our extensive collection</p>

	<!-- COvermyer: MOVED FILTERING TO FORM TO ALLOW THYMELEAF ACTIONS-->
	<form method="get" class="filters" th:action="@{/games}">
		<div class="field">
			<label for="genre">Genre</label>
			<select id="genre" name="genre" >
				<option value="" th:selected="${param.genre == null or param.genre == ''}">All Genres</option>
			<option value="Action" th:selected="${param.genre == 'Action'}">Action</option>
			<option value="RPG" th:selected="${param.genre == 'RPG'}">RPG</option>
			<option value="Racing" th:selected="${param.genre == 'Racing'}">Racing</option>
			<option value="Adventure" th:selected="${param.genre == 'Adventure'}">Adventure</option>
			<option value="Sports" th:selected="${param.genre == 'Sports'}">Sports</option>
		</select>
		</div>
		<div class="field">
			<label for="platform">Platform</label>
			<select id="platform" name="platform" >
				<option value="" th:selected="${param.platform == null or param.platform == ''}">All Platforms</option>
				<option value="PC" th:selected="${param.platform == 'PC'}">PC</option>
				<option value="PlayStation" th:selected="${param.platform == 'PlayStation'}">PlayStation</option>
				<option value="Xbox" th:selected="${param.platform == 'Xbox'}">Xbox</option>
				<option value="Nintendo" th:selected="${param.platform == 'Nintendo'}">Nintendo</option>
			</select>
		</div>
		<div class="field">
			<label for="maxPrice">Max Price</label>
			<select id="maxPrice" name="maxPrice">
				<option value="" th:selected="${param.maxPrice == null or param.maxPrice == ''}">Any Price</option>
				<option value="20" th:selected="${param.maxPrice == '20'}">$20</option>
				<option value="40" th:selected="${param.maxPrice == '40'}">$40</option>
				<option value="60" th:selected="${param.maxPrice == '60'}">$60</option>
			</select>
		</div>
		<div class="field">
			<label for="minRating">Min Rating</label>
			<select id="minRating" name="minRating">
				<option value="" th:selected="${param.minRating == null or param.minRating == ''}">Any Rating</option>
				<option value="3" th:selected="${param.minRating == '3'}">3+</option>
				<option value="4" th:selected="${param.minRating == '4'}">4+</option>
				<option value="4.5" th:selected="${param.minRating == '4.5'}">4.5+</option>
			</select>
		</div>
		
		<div class="field" style="align-self:flex-end;">
			<button type="submit" class="btn-primary">Filter</button>
		</div>	
	</form>

	<!-- COvermyer: ADDED FOR SERVER SIDER RENDERING -->
    <!-- Results -->
    <section class="grid" id="grid">
		<div th:each="game : ${games}">
			<img class="thumb" th:src="${game.img}" th:alt="${game.title}">
			<div class="pad">
				<div class="name" th:text="${game.title}">Game Name</div>
				<div class="meta" th:text="${game.genre + ' • ' + game.platform + ' • ⭐ ' + game.rating}"></div>
				<div class="price" th:text="'$' + ${#numbers.formatDecimal(game.price, 1, 2)}"></div>
			</div>
		</div>
		<!-- Show message if no games found -->
		<p th:if="${#lists.isEmpty(games)}" style="grid-column: 1 / -1; text-align:center; color:var(--muted); font-size:16px;">
			No games found. Try different filters.
		</p>
	</section>

    <div class="center">
      <button class="btn btn-primary" id="loadMore">Load More Games</button>
    </div>
  </main>
  
  <!-- COvermyer: REMOVED CLIENT SIDE RENDERING-->
</body>
</html>
